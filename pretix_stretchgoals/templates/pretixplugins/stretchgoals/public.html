{% extends "pretixpresale/event/base.html" %}
{% load i18n %}
{% load bootstrap3 %}
{% load rich_text %}
{% load staticfiles %}

{% if request.event.stretchgoals_is_public %}

    {% block custom_header %}
        <script type="text/javascript" src="{% static "charts/raphael-min.js" %}"></script>
        <script type="text/javascript" src="{% static "charts/morris.js" %}"></script>
        <link rel="stylesheet" href="{% static "charts/morris.css" %}" type="text/css" />
    {% endblock %}

    {% block title %}{% trans "Presale Goals" %} :: {{ event.name }}{% endblock %}

    {% block content %}
        <h2>{% trans "Presale Goals" %}</h2>

        {% blocktrans trimmed %}
        {% endblocktrans %}

        {{ public_text|rich_text }}

        {% if request.event.settings.stretchgoals_chart_totals %}
            {% include "pretixplugins/stretchgoals/chart.html" with data=data.total_data label="total" %}
            {% if request.event.settings.stretchgoals_calculation_text %}
                <ul>
                    {% for goal in goals %}
                        <li>
                            {% if goal.total_left <= 0 %}
                                {% blocktrans trimmed with total=goal.total number=forloop.counter %}
                                    Goal #{{ number }} of {{ total }} € has been met!
                                {% endblocktrans %}
                            {% else %}
                                {% blocktrans trimmed with total=goal.total left=goal.total_left number=forloop.counter  %}
                                To reach goal #{{ number }} of {{ total }} €, the remaining tickets need to sell for a total of {{ left }} €.
                                {% endblocktrans %}
                            {% endif %}
                        </li>
                    {% endfor %}
                </ul>
            {% endif %}
        {% endif %}

        {% if request.event.settings.stretchgoals_chart_averages %}
            {% include "pretixplugins/stretchgoals/chart.html" with data=data.avg_data label="avg" %}
            {% if request.event.settings.stretchgoals_calculation_text %}
                <ul>
                    {% for goal in goals %}{% if goal.avg_required %}
                        <li>
                            {% if goal.avg_required <= 0 %}
                                {% blocktrans trimmed with total=goal.avg number=forloop.counter %}
                                    Goal #{{ number }} of {{ total }} € average sales price has been met!
                                {% endblocktrans %}
                            {% else %}
                                {% blocktrans trimmed with total=goal.avg number=forloop.counter required=goal.avg_required %}
                                To reach goal #{{ number }} of {{ total }} € average sales price, the remaining tickets need to sell at an average of {{ required }} €.
                                {% endblocktrans %}
                            {% endif %}
                        </li>
                    {% endif %}{% endfor %}
                </ul>
            {% endif %}
        {% endif %}
    {% endblock %}

{% endif %}
